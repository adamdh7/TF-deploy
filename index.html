<!doctype html>
<html lang="ht">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <meta name="theme-color" content="#FFFFFF">
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" type="image/png" href="https://cliquez.pages.dev/asset/1024.png" />
  <link rel="apple-touch-icon" href="https://cliquez.pages.dev/asset/1024.png" />
  <title>üòÇüëçüèªOn ti click</title>
  <style>
    :root{
      --bg:#f2f5f7;
      --card:#ffffff;
      --accent:#007aff;
      --muted:#8e8e93;
    }
    html,body{
      height:100%;
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      background:linear-gradient(180deg,var(--bg),#eef3f6);
      -webkit-user-select:none;
      user-select:none;
      -webkit-touch-callout:none;
      overscroll-behavior-y:none;
    }
    .wrap{
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
      box-sizing:border-box;
    }
    .card{
      width:100%;
      max-width:420px;
      background:var(--card);
      border-radius:16px;
      box-shadow:0 6px 24px rgba(0,0,0,0.08);
      padding:18px;
      box-sizing:border-box;
    }
    .title{
      font-size:20px;
      font-weight:600;
      margin:0 0 10px 0;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .counters{
      display:flex;
      gap:8px;
      justify-content:space-between;
      margin-bottom:16px;
      align-items:center;
    }
    .counter{
      flex:1;
      background:linear-gradient(180deg,#fbfcfd,#f7f9fb);
      border-radius:12px;
      padding:10px;
      text-align:center;
      min-width:0;
    }
    .label{
      font-size:12px;
      color:var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .value{
      font-size:16px;
      font-weight:700;
      margin-top:6px;
    }
    .btn-row{
      display:flex;
      gap:10px;
      margin-top:12px;
      align-items:center;
    }
    .btn{
      flex:1;
      padding:14px 12px;
      border-radius:12px;
      border:0;
      font-size:16px;
      font-weight:600;
      background:var(--accent);
      color:white;
      -webkit-tap-highlight-color:transparent;
    }
    .info{
      margin-top:12px;
      color:var(--muted);
      font-size:13px;
      line-height:1.3;
    }
    .truncate{
      display:block;
      -webkit-line-clamp:1;
      -webkit-box-orient:vertical;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    html,body,input,button{touch-action:manipulation;}
    @media (max-width:380px){
      .title{font-size:18px;}
      .value{font-size:15px;}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="main">
      <h1 class="title truncate"></h1>
      <div class="counters" aria-live="polite">
        <div class="counter" title="S - Semaine derni√®re">
          <div class="label">S</div>
          <div id="count-week" class="value">0</div>
        </div>
        <div class="counter" title="Y - Hier">
          <div class="label">Y</div>
          <div id="count-yesterday" class="value">0</div>
        </div>
        <div class="counter" title="J - Aujourd'hui">
          <div class="label">J</div>
          <div id="count-today" class="value">0</div>
        </div>
        <div class="counter" title="T - Total">
          <div class="label">T</div>
          <div id="count-total" class="value">0</div>
        </div>
      </div>
      <div class="btn-row">
        <button id="redirectBtn" class="btn" type="button">Cliquez</button>
      </div>
      <p class="info">NB: reste 7s minimum</p>
    </div>
  </div>

  <script>
    (function(){
      var s = document.createElement('script');
      s.type = 'text/javascript';
      s.async = true;
      s.src = '//pl28135197.effectivegatecpm.com/3b/5a/09/3b5a097d28211945158c20a3f4879260.js';
      document.body.appendChild(s);
    })();
  </script>

  <script>
    (function(){
      const REDIRECT_URL = 'https://www.effectivegatecpm.com/sb8frb30?key=b74cd3abdfc6db3be0c0b8d215fcb582';
      const REQUIRED_SECONDS = 7000;
      const POLL_MS = 250;
      const STORAGE_KEY = 'egc_counter_v1';

      function loadState(){
        try{
          const raw = localStorage.getItem(STORAGE_KEY);
          if(!raw) return defaultState();
          const obj = JSON.parse(raw);
          if(!obj._meta || typeof obj.total !== 'number') return defaultState();
          rotateIfNeeded(obj);
          return obj;
        }catch(e){ return defaultState(); }
      }
      function defaultState(){
        const today = isoDate(new Date());
        const weekKey = weekKeyFromDate(new Date());
        return {_meta:{lastUpdate:today,weekKey},todayDate:today,today:0,yesterday:0,week:0,total:0};
      }
      function saveState(s){ localStorage.setItem(STORAGE_KEY, JSON.stringify(s)); }
      function isoDate(d){ return d.toISOString().slice(0,10); }
      function weekKeyFromDate(d){
        const tmp = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
        const dayNum = tmp.getUTCDay() || 7;
        tmp.setUTCDate(tmp.getUTCDate() + 4 - dayNum);
        const yearStart = new Date(Date.UTC(tmp.getUTCFullYear(),0,1));
        const weekNo = Math.ceil(((tmp - yearStart) / 86400000 + 1) / 7);
        return tmp.getUTCFullYear() + '-W' + String(weekNo).padStart(2,'0');
      }
      function rotateIfNeeded(state){
        const today = isoDate(new Date());
        if(state.todayDate !== today){
          state.yesterday = state.today;
          state.today = 0;
          state.todayDate = today;
          state._meta.lastUpdate = today;
        }
        const wk = weekKeyFromDate(new Date());
        if(state._meta.weekKey !== wk){
          state.week = 0;
          state._meta.weekKey = wk;
        }
      }

      const elToday = document.getElementById('count-today');
      const elYest = document.getElementById('count-yesterday');
      const elWeek = document.getElementById('count-week');
      const elTotal = document.getElementById('count-total');

      let state = loadState();
      render();

      function render(){
        elToday.textContent = formatMoney(state.today);
        elYest.textContent = formatMoney(state.yesterday);
        elWeek.textContent = formatMoney(state.week);
        elTotal.textContent = formatMoney(state.total);
        saveState(state);
      }
      function formatMoney(n){ return '' + String(n); }

      function incrementCounts(){
        rotateIfNeeded(state);
        state.today += 1;
        state.week += 1;
        state.total += 1;
        render();
      }

      document.getElementById('redirectBtn').addEventListener('click', function(){
        let newWin;
        try{ newWin = window.open(REDIRECT_URL, 'egc_external_window'); }catch(err){ newWin = null; }
        if(!newWin){ alert('Ouv√®ti tab/fen√®t bloke. Eseye p√®m√®t popups oswa kite bouton an louvri lyen dir√®kteman.'); return; }
        const start = Date.now();
        let counted = false;
        const poll = setInterval(() => {
          try{
            if(newWin.closed){ clearInterval(poll); return; }
            if(!counted && (Date.now() - start) >= REQUIRED_SECONDS){
              counted = true;
              incrementCounts();
            }
          }catch(err){ clearInterval(poll); }
        }, POLL_MS);
        setTimeout(()=> clearInterval(poll), 60000);
      });

      (function tryPreventPullToRefresh(){
        document.addEventListener('touchstart', function(){}, {passive:true});
        let lastY = 0;
        window.addEventListener('touchmove', function(e){
          if(window.scrollY === 0 && e.touches && e.touches.length === 1){
            const curY = e.touches[0].clientY;
            if(curY > lastY + 8){ e.preventDefault(); }
            lastY = curY;
          }
        }, {passive:false});
      })();

      window._egc_state = { get:() => state, inc:() => incrementCounts() };
    })();
  </script>

  <script>
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('/sw.js').catch(()=>{});
    }
  </script>
</body>
  </html>
